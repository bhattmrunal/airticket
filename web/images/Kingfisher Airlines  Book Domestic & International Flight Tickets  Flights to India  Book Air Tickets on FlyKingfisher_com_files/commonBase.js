// errorMessages.js
// Error Messages from 
arrErr['020']="#1 should only contain letters and numbers.";arrErr['008']="Maximum #1 guests allowed.";arrErr['001']="#1 cannot be blank.";arrErr['014']="Invalid character(s) #1 exist in #2. Please check and enter again.";arrErr['016']="Maximum of only #1 guests are allowed for a travelling party.";arrErr['003']="From & To locations cannot be the same.";arrErr['012']="Return date must be #1 hours ahead from current date.";arrErr['004']="Please select #1.";arrErr['022']="Miles cannot be redeemed for promotions.";arrErr['006']="#1 cannot be before the #2.";arrErr['013']="Child cannot travel alone.";arrErr['010']="No flights found. Please call our Call Centre for your booking.";arrErr['007']="Invalid #1.";arrErr['009']="Please select the number of guests.";arrErr['017']="#1 cannot contain any characters other than letters.";arrErr['021']="#1 cannot be greater than #2.";arrErr['015']="Low fare search cannot be used.";arrErr['018']="#1 should contain only letters.";arrErr['005']="#1 cannot be before the current date.";arrErr['011']="Departure date must be #1 day(s) ahead from current date.";arrErr['019']="#1 should be numeric.";

//timeOut.js
var strTimeOut='15:00';var intTimeLimit=0;var blnTimerEnable=true;var objTimer=null;var strTimeOutLstMsg="The #1 minutes timeout for completing this booking has expired.  You will now be transferred back to the flight selection page.";var strTimeSesExpMsg="Your Session Expired.";function setTimer(){if(top.strTimeOut!=""){if(document.images){var arrTimeLimit=top.strTimeOut.split(':');intTimeLimit=arrTimeLimit[0]*60+arrTimeLimit[1]*1}if(objTimer!=null){clearTimeout(objTimer)}startTimer()}}function startTimer(){if(blnTimerEnable){if(intTimeLimit==0){clearTimeout(objTimer);alert(replaceAll(strTimeOutLstMsg,"#1",strTimeOut));DivWrite("spnTimeMsg","<font class='fntBold'>"+strTimeSesExpMsg+"<\/font>");loadMyHomePage()}else{var strCTime,intMin,intSec,intRemainMin;intTimeLimit-=1;intMin=Math.floor(intTimeLimit/60);intSec=intTimeLimit%60;intRemainMin=intMin+1;DivWrite("spnTimerValue",intRemainMin);objTimer=setTimeout('startTimer()',1000)}}}

//home.js
var objLB=new listBox();var blnSrchOpt=false;var blnSchedule=false;var skipValidate=false;var objSelFrom=new filterDropDown();var skipOnTheSpotPopUpReturn=false;objSelFrom.id="spnFrom";objSelFrom.width="135px";objSelFrom.listWidth="152px";objSelFrom.dataArray=arrCityOptTags;objSelFrom.tabIndex=3;objSelFrom.imgPath=strImgUrl;objSelFrom.folderPath="js/";objSelFrom.onClick="pgFromOnClick";objSelFrom.onSelect="pgAirportFromMessage";objSelFrom.wrapText=false;objSelFrom.noMatchingText="There are no cities matching your request.";objSelFrom.defaultText="--Origin--";var objSelTo=new filterDropDown();objSelTo.id="spnTo";objSelTo.width="135px";objSelTo.listWidth="152px";objSelTo.dataArray=arrCityOptTags;objSelTo.tabIndex=6;objSelTo.imgPath=strImgUrl;objSelTo.folderPath="js/";objSelTo.onClick="pgToOnClick";objSelTo.onSelect="pgAirportToMessage";objSelTo.wrapText=false;objSelTo.noMatchingText="There are no cities matching your request.";objSelTo.defaultText="--Destination--";objSelTo.displayFilterDropDown();var bolFromClick=false;var bolToClick=false;function pgFromOnClick(a){bolFromClick=true;if(objSelTo.currentStatus){objSelTo.collapse()}}function pgToOnClick(a){if(objSelFrom.currentStatus){objSelFrom.collapse()}}function controlFocus(){if(objSelFrom.currentStatus){objSelFrom.collapse()}if(objSelTo.currentStatus){objSelTo.collapse()}}var objCal=new Calendar("spnCalendar");objCal.align="left";objCal.top=0;objCal.left=0;objCal.disableUpto=strPrmSysDate;objCal.disableFrom=getCalenderEndDate(12,strPrmSysDate);objCal.onClick="setDate";objCal.imagePath=strImgUrl;objCal.imgPathNav=strImgUrl;objCal.yearRange="FIXED";objCal.noYears=1;objCal.currentDate=strPrmSysDate;objCal.yearLock=true;var objCalPop=new Calendar("spnCalendarPop");objCalPop.align="left";objCalPop.top=0;objCalPop.left=0;objCalPop.disableUpto=strPrmSysDate;objCalPop.disableFrom=getCalenderEndDate(12,strPrmSysDate);objCalPop.onClick="setDatePop";objCalPop.imagePath=strImgUrl;objCalPop.imgPathNav=strImgUrl;objCalPop.yearRange="FIXED";objCalPop.noYears=1;objCalPop.currentDate=strPrmSysDate;objCalPop.yearLock=true;objCalPop.blnDragCalendar=false;function pgBtnClick(a){if(document.getElementById("txtBPromoCode")){if(document.getElementById("txtBPromoCode").value=="Enter Promo Code"){document.getElementById("txtBPromoCode").value=""}}switch(a){case 0:if(skipValidate||bkgValidate()){if("true"==getValue(arrControls[11][0])){CallIBERedemption()}else{hdnMode="BKG";if(blnSchedule&&strByFlight&&getValue(arrControls[0][0])=="R"){hdnMode="SCH"}buildBookingData();buildBookingDataGET();blnCusProgress=true;showProgress();if(strByFlight){pgSubmit(false)}else{pgSubmit(true)}}}break;case 1:if(mbValidate()){hdnMode="MB";buildMBData();pgSubmit(false)}break;case 2:if(wcValidate()){hdnMode="WC";buildWCData();pgSubmit(false)}break;case 3:hdnMode="MS";pgSubmit(false);break;case 4:hdnMode="VC";pgSubmit(false);break;case 5:hdnMode="AgtEnrollment";pgSubmit(false);break;case 6:hdnMode="FltSch";pgSubmit(false);break;case 7:strImptNote=getTierLevelInfo();alert(strImptNote);break}}function searchByFlightOnly(){strBestFare=false;strByFlight=true;pgBtnClick(0)}function searchByBestFare(){strBestFare=true;strByFlight=false;pgBtnClick(0)}var lastFromAirport="";function pgAirportFromMessage(){if(lastFromAirport==objSelFrom.value){return}lastFromAirport=objSelFrom.value;for(var a=0;a<arrCityOptTags.length;a++){if(arrCityOptTags[a][0]==objSelFrom.value){if(arrCityOptTags[a][3]!=""){alert(arrCityOptTags[a][3])}break}}restrictUSDCheck()}var lastToAirport="";function pgAirportToMessage(){if(lastToAirport==objSelTo.value){return}lastToAirport=objSelTo.value;for(var a=0;a<arrCityOptTags.length;a++){if(arrCityOptTags[a][0]==objSelTo.value){if(arrCityOptTags[a][2]!=""){alert(arrCityOptTags[a][2])}break}}}function restrictUSDCheck(){if(objSelFrom.value=="LHR"||objSelFrom.value=="DXB"||objSelFrom.value=="SIN"||objSelFrom.value=="DAC"||objSelFrom.value=="BKK"||objSelFrom.value=="HKG"||objSelFrom.value=="CMB"){setChecked("chkCurrency",false);Disable("chkCurrency",true)}else{Disable("chkCurrency",false)}}function reSetPopupDate(b,a){setField(arrRetrunPopUpControls[1][0],a);selPopRMonYearOnChange();setField(arrRetrunPopUpControls[0][0],b);selPopRDayOnChange()}function autoFillDate(){if(getValue(arrControls[2][0])!=""&&getValue(arrControls[3][0])!=""){var c=getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0]);var a=addDays(StringToDate(c),2);var e=a.getMonth()+1;var d=a.getDate();if(e<10){e="0"+e}if(d<10){d="0"+d}var b=e+"/"+a.getFullYear();if(getValue(arrControls[0][0])=="R"){setField(arrControls[5][0],b);selRMonYearOnChange();setField(arrControls[4][0],d);selRDayOnChange()}else{reSetPopupDate(d,b)}if((getValue(arrControls[5][0])!=b)||(getValue(arrControls[4][0])!=d)){if(getValue(arrControls[0][0])=="R"){setField(arrControls[5][0],getValue(arrControls[3][0]));selRMonYearOnChange();setField(arrControls[4][0],getValue(arrControls[2][0]));selRDayOnChange()}}if(getValue(arrControls[0][0])=="O"){if((getValue(arrRetrunPopUpControls[1][0])!=b)||(getValue(arrRetrunPopUpControls[0][0])!=d)){reSetPopupDate(getValue(arrControls[2][0]),getValue(arrControls[3][0]))}}}}function bkgValidate(){pgInitializeErrMsg();if(objSelFrom.value==""){strErrMsg=buildError(objTop.arrErr["004"],strTxtBFrom);objSelFrom.focus()}if(strErrMsg==""){if(objSelFrom.text==""){strErrMsg=buildError(objTop.arrErr["004"],strTxtBFrom)}}if(strErrMsg==""){if(objSelTo.value==""){strErrMsg=buildError(objTop.arrErr["004"],strTxtBTo);objSelTo.focus()}}if(strErrMsg==""){if(objSelTo.text==""){strErrMsg=buildError(objTop.arrErr["004"],strTxtBTo);objSelTo.focus()}}if(strErrMsg==""){var a=Number(getValue(arrControls[6][0]));a+=Number(getValue(arrControls[7][0]));a+=Number(getValue(arrControls[8][0]));if(intMaxPax<a){var c="While booking a ticket on our website, please keep in mind the following rules regarding number of guests in a traveling:\n\n1.A maximum of 6 guests per traveling party.\n\n2.A Child booking has to have an accompanying Adult booking in order to be valid.\n\n3. Each Infant ticket booked will have to have a corresponding Adult Ticket booked.\n Eg:- For 2 infant tickets, 2 adult tickets are mandatory.";strErrMsg=buildError(c);setFocus(arrControls[6][0])}}if(strErrMsg==""){strErrMsg=pgValidateInvalidChar(arrControls)}if(strErrMsg==""){strErrMsg=pgValidateEmpty("0,1,2,3,4,5,6,7,8,9,10",arrControls)}if(strErrMsg==""){if(objSelFrom.value==objSelTo.value){strErrMsg=buildError(arrErr["003"]);objSelTo.focus()}}var e=getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0]);var f=getValue(arrControls[4][0])+"/"+getValue(arrControls[5][0]);if(strErrMsg==""){if(!CheckDates(objTop.strPrmSysDate,e)){strErrMsg=buildError(arrErr["011"],arrControls[2][1]);setFocus(arrControls[2][0])}var d=DateToString(addDays(StringToDate(objTop.strPrmSysDate),intMaxSearchDays));if(strErrMsg==""&&!CheckDates(e,d)){strErrMsg=buildError(arrErr["021"],arrControls[2][1],d);setFocus(arrControls[2][0])}if(strErrMsg==""&&getValue(arrControls[0][0])=="R"){if(!CheckDates(f,d)){strErrMsg=buildError(arrErr["021"],arrControls[4][1],d);setFocus(arrControls[4][0])}}}if(getValue(arrControls[0][0])=="R"){if(strErrMsg==""){if(!CheckDates(objTop.strPrmSysDate,f)){strErrMsg=buildError(arrErr["011"],arrControls[4][1]);setFocus(arrControls[4][0])}}if(strErrMsg==""){if(!CheckDates(e,f)){strErrMsg=buildError(arrErr["006"],arrControls[4][1],arrControls[2][1]);setFocus(arrControls[4][0])}}}if((getValue(arrControls[12][0])!="")&&(getValue(arrControls[11][0])=="true")){strErrMsg=arrErr["022"];setFocus(arrControls[12][0])}if(strErrMsg){pgShowErrMsg(strErrMsg);return false}if(getValue(arrControls[11][0])=="true"&&getValue(arrControls[8][0])!="0"){alert("Online Redemption ticketing with Infant is not allowed. Please contact Call center at 1800 209 3030.");return false}var b="N";if(b=="N"&&strVendor=="N"){if(isReturnMsgEnabled){if(getValue(arrControls[0][0])=="O"){if(strErrMsg==""){showReturnMsg();return false}}}}return true}function showReturnMsg(){returnPopupOnLoad();$("#fuzz").fadeIn();return false}function mbValidate(){}function wcValidate(){}function setProgressCusMessages(){try{strHeader1=objSelFrom.text+"("+objSelFrom.value+") - ";strHeader1+=objSelTo.text+"("+objSelTo.value+")";strHeader2="Departing - ";strHeader2+=dateChk(getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0]),strDDMMMMYYY);strHeader2+=" ("+getWDayText(getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0]))+")";if(getValue(arrControls[0][0])=="R"){strHeader2+=" Returning - ";strHeader2+=dateChk(getValue(arrControls[4][0])+"/"+getValue(arrControls[5][0]),strDDMMMMYYY);strHeader2+=" ("+getWDayText(getValue(arrControls[4][0])+"/"+getValue(arrControls[5][0]))+")"}}catch(a){}DivWrite("spnProgressHeader01",strHeader1);DivWrite("spnProgressHeader02",strHeader2);DivWrite("spnProgressHeader03","We are retrieving your flight information")}function buildBookingData(){hdnData="";var b=arrControls.length;var a=0;do{if(a==13||a==14){a++;continue}if(a==12&&document.getElementById("chkPromo").checked!=true){hdnData+=" ^";a++;continue}hdnData+=getValue(arrControls[a][0])+" ^";switch(a){case 1:hdnData+=objSelFrom.value+" ^";hdnData+=objSelFrom.text+" ^";hdnData+=objSelTo.value+" ^";hdnData+=objSelTo.text+" ^";break;case 3:if(getValue(arrControls[0][0])!="R"){hdnData+=" ^";hdnData+=" ^";a=a+2;b=b-2}break}a++}while(--b);hdnData+=getText(arrControls[9][0])+" ^";hdnData+=getText(arrControls[10][0])+" ^";if(blnSchedule&&getValue(arrControls[0][0])!="R"){hdnData+="SCH ^"}else{hdnData+="BKG ^"}hdnData+=getSelectedCountryCode(objSelFrom.value)+" ^";hdnData+=document.getElementById("chkCurrency").checked}function buildBookingDataGET(){$("#tripType").val(getValue(arrControls[0][0]));$("#srchMode").val(getValue(arrControls[1][0]));var a=objSelFrom.value;$("#origin").val(a);$("#originDsc").val(objSelFrom.text);$("#dest").val(objSelTo.value);$("#destDsc").val(objSelTo.text);$("#depDate").val(getDepartureDate());$("#arrDate").val(getArrivalDate());$("#adt").val(getValue(arrControls[6][0]));$("#chld").val(getValue(arrControls[7][0]));$("#inf").val(getValue(arrControls[8][0]));$("#cos").val(getValue(arrControls[9][0]));$("#connFlt").val(getValue(arrControls[10][0]));$("#useKingMiles").val(getValue(arrControls[11][0]));$("#cosDsc").val(getText(arrControls[9][0]));$("#connFltDsc").val(getText(arrControls[10][0]));$("#searchType").val(getSearchType());$("#isUSD").val(getValue("chkCurrency"));$("#promoCode").val(getValue(arrControls[12][0]));$("#country").val(getSelectedCountryCode(a))}function getSearchType(){if(blnSchedule&&getValue(arrControls[0][0])!="R"){return"SCH"}else{return"BKG"}}function getDepartureDate(){var a=getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0]);return a}function getArrivalDate(){if(getValue(arrControls[0][0])=="R"){var a=getValue(arrControls[4][0])+"/"+getValue(arrControls[5][0]);return a}return""}function getSelectedCountryCode(b){for(var a=0;a<arrAirportsAndStations.length;a++){if(arrAirportsAndStations[a][0]==b){return arrAirportsAndStations[a][1]}}return""}function buildMBData(){}function buildWCData(){}function pgSubmit(d){setField("hdnMode",hdnMode);setField("hdnSourceURL",strPrmHomeURL);setField("hdnLang","en");setField("hdnCountryCode",strCountryCode);if(document.getElementById("hdnOriginCode").value==""){setField("hdnOriginCode",strOriginCode)}setField("hdnCrLoginId",hdnCrLoginId);setField("hdnCrLoginPassword",hdnCrLoginPassword);setField("hdnCrLoginMode",hdnCrLoginMode);setField("hdnVoucher",hdnCrVoucher);setField("hdnHeader1",strHeader1);setField("hdnHeader2",strHeader2);setField("hdnByFlight",strByFlight);setField("hdnBestFare",strBestFare);var a="";switch(hdnMode){case"WC":a=strPrmWCURL;setField("hdnFlowSequence","1");break;case"MB":a=strPrmBkgURL;break;case"MS":a=strPrmBkgMultiURL;break;case"BKG":if(getValue(arrControls[11][0])=="true"){a=strPrmRedimURL}else{a=strPrmBkgURL}break;case"SCH":if(getValue(arrControls[11][0])=="true"){a=strPrmRedimURL}else{a=strPrmBkgURL}break;case"VC":a=strPrmBkgURL;break;case"AgtEnrollment":a="showAgentsEnrollment.action";break;case"FltSch":a=strPrmSchURL;break}var c="post";if(d){c="get"}else{setField("hdnData",hdnData)}var b=getFieldByID("frmDummy");b.action=a;b.target="_top";b.method=c;b.submit()}function tabClick(g){var a=g;var e=arrTab.length;var b=0;var h=false;g=0;var d="";d+=" <table width='380' border='0' cellspacing='0' cellpadding='0' style='cursor: hand;'>";d+=" <tr>";var f="";var c="";do{f="onClick = 'tabClick("+b+")'";if(b==g){h=true;c=arrTab[b][3]}else{h=false;c=arrTab[b][2]}d+=" <td width='"+arrTab[b][1]+"' align='left' valign='top' "+f+" style='cursor:pointer'><img src='"+strImgUrl+c+"' width='"+arrTab[b][1]+"' height='34' style='cursor:pointer'/></td>";b++}while(--e);d+=" </tr>";d+=" </table>";DivWrite("spnTab",d);switch(a){case 0:break;case 1:window.location=strFlightStatus;break;case 2:window.location=strManageBooking;break;case 3:window.location=strWebCheckIn;break}setFocus(arrControls[0][0])}function ratBTripOnClick(){var a=false;setCabinClasses();switch(getValue(arrControls[0][0])){case"R":a=true;break;case"O":a=false;break}setVisible("divRtnCntl",a)}function ratRadBy(){searchKingMiles();if(document.getElementById("chkPromo").checked==true){setField("radByPrice","S");Disable("radByPrice",true)}blnSchedule=false;switch(getValue(arrControls[14][0])){case"S":blnSchedule=true;setChecked(arrControls[13][0],false);Disable(arrControls[13][0],true);break;case"P":blnSchedule=false;Disable(arrControls[13][0],false);break}}function selBAdtOnChange(){var b=new Array();var e=Number(getValue(arrControls[6][0]));var a=getValue(arrControls[8][0]);var f=0;if(Number(intMaxInf)<Number(e)){f=intMaxInf}else{f=e}for(var d=0;d<=f;d++){b[d]=new Array();b[d][0]=d}var c=new listBox();c.dataArray=b;c.textIndex="0";c.id=arrControls[8][0];c.fillListBox();setField(arrControls[8][0],a)}function fillCalenderDay(o,s){var c=getFieldByID(o);var q=getValue(o);var l=addDays(StringToDate(strPrmSysDate),0);var b=Number(strPrmSysDate.substr(3,2));var j=Number(strPrmSysDate.substr(6,4));var d=Number(s.substr(0,2));var e=Number(s.substr(3,4));var n=getDaysInMonth(d,e);var k="";var a=1;if((b==d)&&(e==j)){a=Number(strPrmSysDate.substr(0,2))}var h="";if(arguments.length>2){var r=Number(arguments[2].substr(3,2));var f=Number(arguments[2].substr(6,4));if((d==r)&&(e==f)){h=Number(arguments[2].substr(0,2))}}c.length=0;var g=0;var p=new Array();for(var m=a;m<=n;m++){k=m;if(k<10){k="0"+k}c.length=g+1;c.options[g].value=k;c.options[g].text=k;g++;if(h!=""){if(m>=h){break}}}setField(o,q)}function displayDay(a){switch(a){case 0:if(getValue(arrControls[2][0])!=""){DivWrite("spnDDay",getWDay(getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0])).toUpperCase())}else{DivWrite("spnDDay","")}break;case 1:if(getValue(arrControls[4][0])!=""){DivWrite("spnRDay",getWDay(getValue(arrControls[4][0])+"/"+getValue(arrControls[5][0])).toUpperCase())}else{DivWrite("spnRDay","")}break;case 2:if(getValue(arrRetrunPopUpControls[0][0])!=""){DivWrite("pop_spnRDay",getWDay(getValue(arrRetrunPopUpControls[0][0])+"/"+getValue(arrRetrunPopUpControls[1][0])).toUpperCase())}else{DivWrite("pop_spnRDay","")}break}}function selDMonYearOnChange(){fillCalenderDay(arrControls[2][0],getValue(arrControls[3][0]));displayDay(0)}function selRMonYearOnChange(){fillCalenderDay(arrControls[4][0],getValue(arrControls[5][0]));displayDay(1)}function selPopRMonYearOnChange(){initilizePopUpErrorMsg();fillCalenderDay(arrRetrunPopUpControls[0][0],getValue(arrRetrunPopUpControls[1][0]));displayDay(2)}function selDDayOnChange(){displayDay(0)}function selRDayOnChange(){displayDay(1)}function selPopRDayOnChange(){initilizePopUpErrorMsg();displayDay(2)}function loadCalendar(e,b){objCal.hideCalendar();objCal.ID=e;var c=0;var a=0;var d="";switch(e){case 0:if(getValue(arrControls[2][0])!=""){c="290px";a="240px";d=getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0])}break;case 1:if(getValue(arrControls[4][0])!=""){c="300px";a="240px";d=getValue(arrControls[4][0])+"/"+getValue(arrControls[5][0])}break;case 2:c="130px";a="18px";d=trim(getValue(arrHotel[1][0]));break;case 3:c="130px";a="30px";d=trim(getValue(arrHotel[2][0]));break}objCal.currentDate=d;if(d==""){objCal.currentDate=strPrmSysDate}objCal.top=c;objCal.left=a;objCal.showCalendar(b)}function loadCalendarPop(e,b){objCalPop.hideCalendar();objCalPop.ID=e;var c=0;var a=0;var d="";switch(e){case 0:c="190px";a="500px";d=getValue(arrRetrunPopUpControls[0][0])+"/"+getValue(arrRetrunPopUpControls[1][0]);break}objCalPop.currentDate=d;if(d==""){objCalPop.currentDate=strPrmSysDate}objCalPop.top=c;objCalPop.left=a;objCalPop.showCalendar(b)}function setDate(c,a){var b=c.split("/");switch(a){case"0":setField(arrControls[3][0],b[1]+"/"+b[2]);selDMonYearOnChange();setField(arrControls[2][0],b[0]);selDDayOnChange();autoFillDate();break;case"1":setField(arrControls[5][0],b[1]+"/"+b[2]);selRMonYearOnChange();setField(arrControls[4][0],b[0]);selRDayOnChange();break;case"2":setField(arrHotel[1][0],c);updateHiddenCheckInParameter();break;case"3":setField(arrHotel[2][0],c);updateHiddenCheckOutParameter();break}}function setDatePop(c,a){var b=c.split("/");switch(a){case"0":setField(arrRetrunPopUpControls[1][0],b[1]+"/"+b[2]);selPopRMonYearOnChange();setField(arrRetrunPopUpControls[0][0],b[0]);selPopRDayOnChange();break}}function dateChange(a){switch(a){case 2:dateOnBlur(arrHotel[1][0],a);break;case 3:dateOnBlur(arrHotel[2][0],a);break}}function dateOnBlur(b,a){if(!dateChk(b)){switch(a){case 2:showMessage("E",buildError(arrErr["007"],arrHotel[1][0]));break;case 3:showMessage("E",buildError(arrErr["007"],arrHotel[2][0]));break}setFocus(b);return}else{switch(a){case 2:updateHiddenCheckInParameter();break;case 3:updateHiddenCheckOutParameter();break}}}function searchOpt(){if(blnSrchOpt){blnSrchOpt=false}else{blnSrchOpt=true}setDisplay("divSrchOpt",blnSrchOpt)}function chkWCKMOnClick(){var a=getChecked("chkWCKM");if(!a){setField(arrControlsWC[5][0],"");setField(arrControlsWC[6][0],"");setField(arrControlsWC[7][0],"")}setDisplay("divWCKM",a)}function pgOnHide1(){setDisplay(arrControls[2][0],true);setDisplay(arrControls[3][0],true);setDisplay(arrControls[6][0],true);setDisplay(arrControls[7][0],true)}function pgOnShow1(){setDisplay(arrControls[2][0],false);setDisplay(arrControls[3][0],false);setDisplay(arrControls[6][0],false);setDisplay(arrControls[7][0],false)}function pgOnHide2(){setDisplay(arrControls[4][0],true);setDisplay(arrControls[5][0],true);setDisplay(arrControls[8][0],true)}function pgOnShow2(){setDisplay(arrControls[4][0],false);setDisplay(arrControls[5][0],false);setDisplay(arrControls[8][0],false)}function fillDropDowns(){var c=StringToDate(strPrmSysDate);var e=c.getMonth();var d=c.getFullYear();var f="";var a=intPrmMaxMonths;for(var b=0;b<a;b++){if((e+1)<10){f="0"+(e+1)}else{f=(e+1)}objLB.appendNodesIE(arrControls[3][0],f+"/"+d,arrMonths[e]+" "+d);objLB.appendNodesIE(arrControls[5][0],f+"/"+d,arrMonths[e]+" "+d);e++;if(e>11){e=0;d++}}selDMonYearOnChange();selRMonYearOnChange();var h=new Array();var g=intPrmAdtMax;var b=0;do{h[b]=new Array(b+1,b+1);b++}while(--g);objLB.dataArray=h;objLB.id=arrControls[6][0];objLB.fillListBox();h=new Array();g=(intPrmChldMax+1);var b=0;do{h[b]=new Array(b,b);b++}while(--g);objLB.dataArray=h;objLB.id=arrControls[7][0];objLB.fillListBox();selBAdtOnChange();setField(arrControls[10][0],"NC")}function kfPromoOnClick(){if(document.getElementById("chkPromo").checked==true){setField(arrControls[1][0],"FIXED");setChecked(arrControls[13][0],false);Disable(arrControls[13][0],true);setField("radByPrice","S");ratRadBy();setCabinClasses();Disable("radByPrice",true)}else{setField(arrControls[1][0],"LF_NEW");Disable("radByPrice",false)}}function searchKingMiles(){if(getValue(arrControls[11][0])=="true"){setChecked("radBTDate2",true);setField(arrControls[1][0],"FIXED");Disable("radBTDate",true);Disable("radBTDate3",true);setChecked(arrControls[13][0],false);Disable(arrControls[13][0],true);setField("radByPrice","S");Disable("radByPrice",true)}else{switch(getValue(arrControls[14][0])){case"S":blnSchedule=true;setChecked(arrControls[13][0],false);break}setChecked("radBTDate",true);setField(arrControls[1][0],"LF_NEW");Disable("radBTDate",false);Disable("radBTDate3",false);Disable("radByPrice",false)}}function setDefaultFocus(){}function homeTimeOutStart(){var b="";var a=replaceAll(strTxtTimer,"#1","<b><span id='spnTimerValue'></span></b>");b+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";b+=" <tr>";b+=" <td width='100%' style='background-image:url("+strImgUrl+"KF0019.jpg);background-position:center;background-repeat:repeat-x;' align='center' valign='top'><span id='spnTimeMsg'><font>"+a+"</font></span></td>";b+=" </tr>";b+="</table>";DivWrite("spnTimeWarn",b);top.blnTimerEnable=true;top.setTimer()}function setCabinClasses(){var b=getValue("radByPrice");var a=getValue(arrControls[9][0]);var c=new listBox();c.dataArray=arrCabinClasses;c.valueIndex=0;c.textIndex=1;c.blnFirstEmpty=false;c.id=arrControls[9][0];c.filterIndex=2;c.filter=true;c.filterValue="Y";if(b=="S"&&"R"==getValue(arrControls[0][0])){c.filter=false}c.fillListBox();setField(arrControls[9][0],a)}function getTierLevelInfo(){}function OpenSpecialOffer(){window.open("http://www.flykingfisher.com/public_html/LHR_StudentOffer.html","_blank")}function OpenFlightStatus(){window.open("/plan-book/flight-status.aspx","_parent")}function OpenBuyEcoupon(){window.open("http://ibe.flykingfisher.com/ibe/public/showECoupon.action","_blank")}function CallIBERedemption(){if(getValue(arrControls[11][0])=="true"){hdnMode="BKG";buildBookingData();buildBookingDataGET();blnCusProgress=true;showProgress();pgSubmit(true)}}function chkFlexibleDateOnClick(){if(getChecked(arrControls[13][0])){setField(arrControls[1][0],"FLEX")}else{setField(arrControls[1][0],"LF_NEW")}}function getBookingSearchCriteria(){var H="ssw_RedeemMilesSearchMessage";var F="SSWAirAvailService";var I="";var z="";var G="";var x="";var C="realRequestAir";var m="";var p="";var l="";var n="";var j="";var A="INR";var h="07T7";var f="";var b="";var B="";var e="";var s="";var k="anytimeFromHost";var u="";var E="";var q="anytimeFromHost";var K="";var g="";var a="";var o="";var r="";var w="redeemMiles";var J=new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC");if("R"==getValue(arrControls[0][0])){f="returntravel";e=getValue(arrControls[2][0]);u=getValue(arrControls[4][0]);var D=getValue(arrControls[3][0]).split("/");s=J[D[0]-1];D=getValue(arrControls[5][0]).split("/");E=J[D[0]-1]}else{f="onewaytravel";e=getValue(arrControls[2][0]);u=getValue(arrControls[2][0]);var D=getValue(arrControls[3][0]).split("/");s=J[D[0]-1];E=J[D[0]-1]}m=objSelTo.value;b=objSelFrom.value;B=objSelTo.value;var t;var v;for(var c=0;c<arrAirportsAndStations.length;c++){if(arrAirportsAndStations[c][0]==b){t=arrAirportsAndStations[c][1]}else{if(arrAirportsAndStations[c][0]==B){v=arrAirportsAndStations[c][1]}}}if("IN"==strCountryCode){A="INR";if("IN"!=t||"IN"!=v){h="A1UE"}else{h="07T7"}}else{if("GB"==strCountryCode){A="GBP";h="A1WE"}else{A="USD";h="07U7"}}K=getValue(arrControls[6][0]);g=getValue(arrControls[7][0]);a=getValue(arrControls[8][0]);if("KC,KR"==getValue(arrControls[9][0])){o="CoachClass"}else{if("KF"==getValue(arrControls[9][0])){o="BusinessClass"}else{o=getValue(arrControls[9][0])}}if("NC"==getValue(arrControls[10][0])){r="1"}else{if("N"==getValue(arrControls[10][0])){r="0"}else{r=getValue(arrControls[10][0])}}var d="https://cat.sabresonicweb.com/SSWIT/meridia?";var y="page="+H+"&action="+F+"&requestPage="+I+"&requestAction="+z+"&requestActionType="+G+"&hidReturnCity="+x+"&realRequestAir="+C+"&hidDepartCity="+m+"&depTime="+p+"&retTime="+l+"&retchgmonth="+n+"&depchgmonth="+j+"&currency="+A+"&posid="+h+"&direction="+f+"&departCity="+b+"&returnCity="+B+"&depDay="+e+"&depMonth="+s+"&depTime="+k+"&retDay="+u+"&retMonth="+E+"&retTime="+q+"&ADT="+K+"&CHD="+g+"&INF="+a+"&classService="+o+"&flightType="+r+"&actionType="+w;y=d+y;return y}function redirectToLocation(a){top.location.replace(a)}function checkIfCraneRequest(){if(hdnCrLoginMode!=""&&strOriginCode!=""){if(hdnCrLoginMode=="IBE"){return}if(hdnCrLoginMode=="MGBK"){tabClick(1)}if(hdnCrLoginMode=="REDM"){setChecked(arrControls[11][0],true)}if(hdnCrLoginMode=="WCHK"){tabClick(3)}}}function transferTheSpotReturnData(a){if(a){setField(arrControls[0][0],"O");setField(arrControls[4][0],"");setField(arrControls[5][0],"");selRMonYearOnChange();selRDayOnChange();ratBTripOnClick()}else{setField(arrControls[5][0],getValue(arrRetrunPopUpControls[1][0]));selRMonYearOnChange();setField(arrControls[4][0],getValue(arrRetrunPopUpControls[0][0]));selRDayOnChange()}}function validateReturnPopUpData(){var c="";var a=getValue(arrControls[2][0])+"/"+getValue(arrControls[3][0]);var b=getValue(arrRetrunPopUpControls[0][0])+"/"+getValue(arrRetrunPopUpControls[1][0]);var d=DateToString(addDays(StringToDate(objTop.strPrmSysDate),intMaxSearchDays));if(!CheckDates(b,d)){c=buildError(arrErr["021"],arrRetrunPopUpControls[0][1],d);setFocus(arrRetrunPopUpControls[0][0]);showReturnPopErrorMsg(c);return false}if(!CheckDates(objTop.strPrmSysDate,b)){strErrMsg=buildError(arrErr["011"],arrRetrunPopUpControls[0][1]);setFocus(arrRetrunPopUpControls[0][0]);showReturnPopErrorMsg(strErrMsg);return false}if(!CheckDates(a,b)){strErrMsg=buildError(arrErr["006"],arrRetrunPopUpControls[0][1],arrControls[2][1]);setFocus(arrRetrunPopUpControls[0][0]);showReturnPopErrorMsg(strErrMsg);return false}return true}function onPopupClose(){objCalPop.hideCalendar();transferTheSpotReturnData(true);$("#fuzz").fadeOut()}function initilizePopUpErrorMsg(){$("#divReturnOnTheSpotErrorMsg").empty()}function showReturnPopErrorMsg(a){initilizePopUpErrorMsg();$("#divReturnOnTheSpotErrorMsg").addClass("fntError");$("#divReturnOnTheSpotErrorMsg").append(a)}function setMsgBoxHeight(a){$("#divMsgBox").height(a)}function fillDropDownsForReturnPopUp(){var e=StringToDate(strPrmSysDate);var a=e.getMonth();var f=e.getFullYear();var b="";var c=intPrmMaxMonths;for(var d=0;d<c;d++){if((a+1)<10){b="0"+(a+1)}else{b=(a+1)}objLB.appendNodesIE(arrRetrunPopUpControls[1][0],b+"/"+f,arrMonths[a]+" "+f);a++;if(a>11){a=0;f++}}selPopRMonYearOnChange()}function returnPopupOnLoad(){$("#divReturnOntheSpot").hide();initilizePopUpErrorMsg();setMsgBoxHeight("150px");$("#msgReturnBtn").focus()}function onLoad(){if(strPrmSysDate==""){strPrmSysDate=strSysDate}tabClick(0);ratBTripOnClick();fillDropDowns();setDefaultFocus();blnSrchOpt=false;if(strVendor=="Y"){Disable("chkBKM",true);setDisplay("divVCoupon",false);setDisplay("divMultiImage",false);setDisplay("divMultiButton",false);homeTimeOutStart();setDisplay("spnTimeWarn",false)}var a=new Image();a.src="../images/service-red.jpg";setTimeout("autoFillDate()",100);if(showSearchOpt=="true"){setVisible("srchID",true)}else{setDisplay("srchID",false)}ratRadBy();setCabinClasses();checkIfCraneRequest()}$(document).ready(function(){$("#divReturnOntheSpot").hide();$(".close").click(function(){onPopupClose();return false});$("#msgOnewayBtn").click(function(){skipValidate=true;$("#fuzz").fadeOut();pgBtnClick(0)});$("#msgReturnBtn").click(function(){if(skipOnTheSpotPopUpReturn){setField(arrControls[0][0],"R");ratBTripOnClick();autoFillDate();$("#fuzz").fadeOut();if(document.getElementById("txtBPromoCode").value==""){document.getElementById("txtBPromoCode").value="Enter Promo Code"}}else{setMsgBoxHeight("200px");$("#divReturnOntheSpot").fadeIn()}});$("#btnMsgContinueReturn").click(function(){setField(arrControls[0][0],"R");if(validateReturnPopUpData()){ratBTripOnClick();transferTheSpotReturnData(false);$("#fuzz").fadeOut();setField("hdnPromoMode","true");pgBtnClick(0)}else{setField(arrControls[0][0],"O")}});$(window).bind("resize",function(){$("#fuzz").css("height",$(window).height())});fillDropDownsForReturnPopUp()});onLoad();